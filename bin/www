var _ = require('underscore');
var app = require('../lib/app');
var fs = require('fs');
var http = require('http');
var https = require('https');
var debug = require('tracer').console();
app.set('http_port', process.env.NEWSLYNX_HTTP_PORT || 3000);
var chalk = require('chalk');


function launchServers(options){
  // Launch a server
  var http_port = app.get('http_port');
  var http_server = http.createServer(app).listen(http_port );

  console.log('HTTP listening on port', http_port, '...');
}

// This file can both be run via the command line if given the proper flag or as a nodemodule
var launch_command = process.argv[2];
if (launch_command === 'run'){
  launchServers();
} else if (launch_command){
  throw new Error('If you want to run the server from the command line, you must supply the `run` command: `./bin/www run`.\n')
}

module.exports = {
  run: launchServers
}